Index: app.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import pymysql.cursors\r\nimport dotenv\r\nimport os\r\nfrom flask import Flask, request, render_template, redirect, url_for, abort, flash\r\nfrom flask import session, g\r\n\r\napp = Flask(__name__)\r\napp.secret_key = 'une cle(token) : grain de sel(any random string)'\r\ndef get_db():\r\n    dotenv.load_dotenv()\r\n    if 'db' not in g:\r\n        g.db = pymysql.connect(\r\n            host=\"localhost\",\r\n            user='mrose',\r\n            password='mdp',\r\n            database='BDD_mrose',\r\n            charset=\"utf8mb4\",\r\n            cursorclass=pymysql.cursors.DictCursor\r\n        )\r\n    return g.db\r\n\r\n@app.teardown_appcontext\r\ndef teardown_db(exception):\r\n    db = g.pop('db', None)\r\n    if db is not None:\r\n        db.close()\r\n\r\napp = Flask(__name__)\r\n\r\n@app.route('/')\r\ndef show_accueil():\r\n    return render_template('layout.html')\r\n\r\n@app.route('/collecte/show')\r\ndef show_collecte():\r\n    mycursor = get_db().cursor()\r\n    sql=''' SELECT id_collecte AS id, id_type_dechet AS type, quantite_dechet_collecte AS quantite, id_centre_collecte AS centre, id_tournee AS tournee\r\n    FROM Collecte'''\r\n    mycursor.execute(sql)\r\n    Collecte = mycursor.fetchall()\r\n    sql=''' SELECT lieu_collecte AS lieu , id_centre_collecte as id\r\n    FROM Centre_collecte'''\r\n    mycursor.execute(sql)\r\n    Centre_collecte = mycursor.fetchall()\r\n    sql = ''' SELECT libelle_type_dechet AS libelle , id_type_dechet as id\r\n        FROM type_dechet'''\r\n    mycursor.execute(sql)\r\n    type_dechet = mycursor.fetchall()\r\n    sql = ''' SELECT date_tournee AS date , id_tournee as id\r\n            FROM Tournee'''\r\n    mycursor.execute(sql)\r\n    Tournee = mycursor.fetchall()\r\n    return render_template('collecte/show_collecte.html', collecte=Collecte , centreCollect=Centre_collecte, typeDechet=type_dechet, tournee= Tournee)\r\n\r\n\r\n@app.route('/collecte/add', methods=['GET'])\r\ndef add_collecte():\r\n    print('''affichage du formulaire pour saisir une collecte''')\r\n    return render_template('collecte/add_collecte.html')\r\n\r\n@app.route('/collecte/delete')\r\ndef delete_collecte():\r\n    print('''suppression d'une collecte''')\r\n    id=request.args.get('id', None)\r\n    print(id)\r\n    mycursor = get_db().cursor()\r\n    tuple_param=(id)\r\n    sql=\"DELETE FROM collecte WHERE id_collecte=%s;\"\r\n    mycursor.execute(sql,tuple_param)\r\n\r\n    get_db().commit()\r\n    print(request.args)\r\n    print(request.args.get('id'))\r\n    id=request.args.get('id',0)\r\n    return redirect('/collecte/show')\r\n\r\n@app.route('/collecte/edit', methods=['GET'])\r\ndef edit_collecte():\r\n    print('''affichage du formulaire pour modifier une collecte''')\r\n    print(request.args)\r\n    print(request.args.get('id'))\r\n    id = request.args.get('id')\r\n    mycursor = get_db().cursor()\r\n    sql = '''SELECT id_collecte AS id, id_type_dechet AS type, quantite_dechet_collecte AS quantite, id_centre_collecte AS centre, id_tournee\r\n             FROM Collecte\r\n             WHERE id_collecte=%s;'''\r\n    tuple_param = (id,)\r\n    mycursor.execute(sql, tuple_param)\r\n    Collecte = mycursor.fetchone()\r\n    sql = '''SELECT id_centre_collecte AS id, lieu_collecte AS lieu\r\n             FROM Centre_collecte\r\n             WHERE id_centre_collecte=%s;'''\r\n    mycursor.execute(sql, tuple_param)\r\n    Centre_collecte = mycursor.fetchone()\r\n    sql = '''SELECT id_type_dechet AS id, libelle_type_dechet AS libelle\r\n             FROM type_dechet\r\n             WHERE id_type_dechet=%s;'''\r\n    mycursor.execute(sql, tuple_param)\r\n    type_dechet = mycursor.fetchone()\r\n    sql = '''SELECT date_tournee AS date , id_tournee as id\r\n             FROM Tournee\r\n             WHERE id_tournee=%s;'''\r\n    mycursor.execute(sql, tuple_param)\r\n    Tournee = mycursor.fetchall()\r\n    return render_template('collecte/edit_collecte.html', collecte=Collecte, centreCollect=Centre_collecte, typeDechet=type_dechet, tournee=Tournee)\r\n\r\n\r\n@app.route('/collecte/add', methods=['POST'])\r\ndef valid_add_collecte():\r\n    print('''ajout de la collecte dans le tableau''')\r\n    quantite = request.form.get('quantite')\r\n    type = request.form.get('type')\r\n    centre = request.form.get('centre_collecte')\r\n    tournee = request.form.get('tournee')\r\n    message = 'quantite :' + quantite + ' - type :' + type + ' - centre de collecte :' + centre + ' - tournee : ' + tournee\r\n    print(message)\r\n    mycursor = get_db().cursor()\r\n    tuple_param=(quantite,type)\r\n    sql=\"INSERT INTO Collecte(id_collecte, quantite_dechet_collecte, id_type_dechet, id_centre_collecte, id_tournee) VALUES (NULL, %s, %s);\"\r\n    mycursor.execute(sql,tuple_param)\r\n    get_db().commit()\r\n    return redirect('/collecte/show')\r\n\r\n@app.route('/collecte/edit', methods=['POST'])\r\ndef valid_edit_collecte():\r\n    print('''modification de la collecte dans le tableau''')\r\n    id = request.form.get('id')\r\n    quantite = request.form.get('quantite')\r\n    type = request.form.get('type')\r\n    centre = request.form.get('centre_collecte')\r\n    tournee = request.form.get('tournee')\r\n    message = 'quantite :' + quantite + ' - type :' + type + ' - centre de collecte :' + centre + ' - tournee : ' + tournee + ' pour la collecte d identifiant :' + id\r\n    print(message)\r\n    mycursor = get_db().cursor()\r\n    tuple_param=(quantite,type,id)\r\n    sql=\"UPDATE Collecte SET quantite_dechet_collecte = %s, id_type_dechet= %s, id_centre_collecte= %s, id_tournee= %s WHERE id_collecte=%s;\"\r\n    mycursor.execute(sql,tuple_param)\r\n    get_db().commit()\r\n    return redirect('/collecte/show')\r\n\r\n\r\nif __name__ == '__main__':\r\n    app.run()
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app.py b/app.py
--- a/app.py	(revision 9cf0fe6ddc91f18a96cde3bf6571accbc86c7a73)
+++ b/app.py	(date 1700843679495)
@@ -81,7 +81,7 @@
     print(request.args.get('id'))
     id = request.args.get('id')
     mycursor = get_db().cursor()
-    sql = '''SELECT id_collecte AS id, id_type_dechet AS type, quantite_dechet_collecte AS quantite, id_centre_collecte AS centre, id_tournee
+    sql = '''SELECT id_collecte AS id, id_type_dechet AS type, quantite_dechet_collecte AS quantite, id_centre_collecte AS centre, id_tournee AS tournee
              FROM Collecte
              WHERE id_collecte=%s;'''
     tuple_param = (id,)
Index: templates/nav.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><nav>\r\n    <div class=\"nav\">\r\n        <ul class=\"nav-button\">\r\n            <li id=\"page-actuelle\">\r\n                <a href=\"/\">Tricycleco</a>\r\n            </li>\r\n            <li id=\"autre-page1\">\r\n                <a href=\"/employe/show\">Employés(Awa)</a>\r\n            </li>\r\n            <li id=\"autre-page2\">\r\n                <a href=\"/conteneur/show\">Conteneurs(Arthur)</a>\r\n            </li>\r\n            <li id=\"autre-page3\">\r\n                <a href=\"/tournee/show\">Tournées(Ibrahima)</a>\r\n            </li>\r\n            <li id=\"autre-page4\">\r\n                <a href=\"/collecte/show\">Collectes(Matheo)</a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</nav>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/templates/nav.html b/templates/nav.html
--- a/templates/nav.html	(revision 9cf0fe6ddc91f18a96cde3bf6571accbc86c7a73)
+++ b/templates/nav.html	(date 1700837999095)
@@ -11,7 +11,7 @@
                 <a href="/conteneur/show">Conteneurs(Arthur)</a>
             </li>
             <li id="autre-page3">
-                <a href="/tournee/show">Tournées(Ibrahima)</a>
+                <a href="/Tournee/show">Tournées(Ibrahima)</a>
             </li>
             <li id="autre-page4">
                 <a href="/collecte/show">Collectes(Matheo)</a>
Index: templates/collecte/edit_collecte.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{% extends 'layout.html' %}\r\n\r\n{% block title %}\r\n    <title>modifier une collecte</title>\r\n{% endblock %}\r\n\r\n{% block body %}\r\n    <h1>MODIFIER UNE COLLECTE</h1>\r\n    <hr>\r\n    {% if error %}\r\n        <p><strong>Error:</strong> {{ error }}\r\n    {% endif %}\r\n\r\n    <div>\r\n        <div>\r\n            <form method=\"post\" action=\"/collecte/edit\" >\r\n                <fieldset>\r\n\r\n                    <div>\r\n                        <label for=\"quantite\">Quantité collectée</label>\r\n                        <input type=\"number\" id=\"quantite\" name=\"quantite\" value=\"{{ collecte.quantite }}\" required/>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label for=\"type\">Type de déchet</label>\r\n                        <input type=\"text\" id=\"type\" name=\"type\" value=\"{{ typeDechet.libelle }}\" required/>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label for=\"centre\">Centre de collecte</label>\r\n                        <input type=\"text\" id=\"centre\" name=\"centre\" value=\"{{ centreCollect.lieu }}\" required/>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label for=\"tournee\">Tournée</label>\r\n                        <input type=\"date\" id=\"tournee\" name=\"tournee\" value=\"{{ tournee.date }}\" required/>\r\n                    </div>\r\n\r\n\r\n                    <div>\r\n                        <a href=\"/collecte/show\">Annuler</a>\r\n                        <button type=\"submit\" value=\"Ajouter\" name=\"ajouter\">Ajouter</button>\r\n                    </div>\r\n\r\n                </fieldset>\r\n            </form>\r\n        </div>\r\n    </div>\r\n{% endblock %}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/templates/collecte/edit_collecte.html b/templates/collecte/edit_collecte.html
--- a/templates/collecte/edit_collecte.html	(revision 9cf0fe6ddc91f18a96cde3bf6571accbc86c7a73)
+++ b/templates/collecte/edit_collecte.html	(date 1700843852704)
@@ -23,20 +23,37 @@
 
                     <div>
                         <label for="type">Type de déchet</label>
-                        <input type="text" id="type" name="type" value="{{ typeDechet.libelle }}" required/>
+                        <select name="type" id="type" required>
+                            {% for j in typeDechet %}
+                                <option value="{{ j.id }}"
+                                        {% if typeDechet is defined and j.id ==  typeDechet.id %}selected{% endif %}
+                                > {{ j.libelle }} </option>
+                            {% endfor %}
+                        </select>
                     </div>
 
                     <div>
                         <label for="centre">Centre de collecte</label>
-                        <input type="text" id="centre" name="centre" value="{{ centreCollect.lieu }}" required/>
+                        <select name="centre" id="centre" required>
+                            {% for i in centreCollect %}
+                                <option value="{{ i.id }}"
+                                        {% if centre is defined and i.id ==  centre %}selected{% endif %}
+                                > {{ i.lieu }} </option>
+                            {% endfor %}
+                        </select>
                     </div>
 
                     <div>
-                        <label for="tournee">Tournée</label>
-                        <input type="date" id="tournee" name="tournee" value="{{ tournee.date }}" required/>
+                        <label for="tournee">Tournee</label>
+                        <select name="tournee" id="tournee" required>
+                            {% for k in tournee %}
+                                <option value="{{ k.id }}"
+                                        {% if tournee is defined and k.id ==  tournee %}selected{% endif %}
+                                > {{ k.date }} </option>
+                            {% endfor %}
+                        </select>
                     </div>
 
-
                     <div>
                         <a href="/collecte/show">Annuler</a>
                         <button type="submit" value="Ajouter" name="ajouter">Ajouter</button>
Index: templates/collecte/add_collecte.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{% extends 'layout.html' %}\r\n\r\n{% block title %}\r\n    <title>Ajouter une collecte</title>\r\n{% endblock %}\r\n\r\n{% block body %}\r\n    <h1>AJOUTER UNE COLLECTE</h1>\r\n    <hr>\r\n    {% if error %}\r\n        <p><strong>Error:</strong> {{ error }}\r\n    {% endif %}\r\n\r\n    <div>\r\n        <div>\r\n            <form method=\"post\" action=\"/collecte/add\" >\r\n                <fieldset>\r\n\r\n                    <div>\r\n                        <label for=\"quantite\">Quantité collectée</label>\r\n                        <input type=\"number\" id=\"quantite\" name=\"quantite\"  value=\"\" required/>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label for=\"type\">Type de déchet</label>\r\n                        <input type=\"text\" id=\"type\" name=\"type-dechet\" value=\"\" required/>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label for=\"centre\">Centre de collecte</label>\r\n                        <input type=\"text\" id=\"centre\" name=\"centre\" value=\"\" required/>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label for=\"tournee\">Tournée</label>\r\n                        <input type=\"date\" id=\"tournee\" name=\"tournee\" value=\"\" required/>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <a href=\"/collecte/show\">Annuler</a>\r\n                        <button type=\"submit\">Ajouter</button>\r\n                    </div>\r\n\r\n                </fieldset>\r\n            </form>\r\n        </div>\r\n    </div>\r\n{% endblock %}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/templates/collecte/add_collecte.html b/templates/collecte/add_collecte.html
--- a/templates/collecte/add_collecte.html	(revision 9cf0fe6ddc91f18a96cde3bf6571accbc86c7a73)
+++ b/templates/collecte/add_collecte.html	(date 1700853934250)
@@ -23,17 +23,35 @@
 
                     <div>
                         <label for="type">Type de déchet</label>
-                        <input type="text" id="type" name="type-dechet" value="" required/>
+                        <select name="type" id="type" required>
+                            {% for j in typeDechet %}
+                                <option value="{{ j.id }}"
+                                        {% if typeDechet is defined and j.id ==  typeDechet.id %}selected{% endif %}
+                                ></option>
+                            {% endfor %}
+                        </select>
                     </div>
 
                     <div>
                         <label for="centre">Centre de collecte</label>
-                        <input type="text" id="centre" name="centre" value="" required/>
+                        <select name="centre" id="centre" required>
+                            {% for i in centreCollect %}
+                                <option value="{{ i.id }}"
+                                        {% if centre is defined and i.id ==  centre %}selected{% endif %}
+                                ></option>
+                            {% endfor %}
+                        </select>
                     </div>
 
                     <div>
-                        <label for="tournee">Tournée</label>
-                        <input type="date" id="tournee" name="tournee" value="" required/>
+                        <label for="tournee">Tournee</label>
+                        <select name="tournee" id="tournee" required>
+                            {% for k in tournee %}
+                                <option value="{{ k.id }}"
+                                        {% if tournee is defined and k.id ==  tournee %}selected{% endif %}
+                                ></option>
+                            {% endfor %}
+                        </select>
                     </div>
 
                     <div>
